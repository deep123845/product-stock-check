(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6777:(e,r,t)=>{Promise.resolve().then(t.bind(t,6888))},6888:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var s=t(5155),l=t(2115);let a=e=>{let{onFileContentChange:r}=e,[t,a]=(0,l.useState)(null),[o,n]=(0,l.useState)(null),d=e=>e.split("\n").filter(e=>e.length>0);return(0,s.jsxs)("div",{className:"p-4 border rounded shadow mt-8",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Upload and Parse Text File:"}),(0,s.jsx)("input",{type:"file",accept:".txt",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){a(s.name),n(null);let e=new FileReader;e.onload=e=>{if(e.target&&"string"==typeof e.target.result){let t=e.target.result;r&&r(d(t))}},e.onerror=()=>{n("Failed to read file."),r&&r([])},e.readAsText(s)}else a(null),n("No file selected."),r&&r([])},className:"mb-4"}),o&&(0,s.jsxs)("div",{className:"text-red-500 mb-2",children:["Error: ",o]}),t&&(0,s.jsxs)("p",{className:"mb-2",children:["Selected file: ",(0,s.jsx)("span",{className:"font-semibold",children:t})]})]})},o=e=>{let{productHistory:r,months:t}=e,a=Object.keys(t).map(Number).sort((e,r)=>r-e),[o,n]=(0,l.useState)(0),[d,c]=(0,l.useState)(!0),[i,h]=(0,l.useState)(new Date().getDate()),[m,p]=(0,l.useState)(4),[u,b]=(0,l.useState)({}),[x,g]=(0,l.useState)(45),[N,f]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=localStorage.getItem("unitsPerPack");e&&b(JSON.parse(e))},[]);let j=(e=>{if(!e||0===e.length)return{};let r={};for(let t=0;t<e.length;t++){let s=e[t],l=Math.min(...Object.keys(s.sales).map(Number));r[s.productNo]=l}return r})(r),y=i/new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),k=(()=>{if(!r||0===r.length)return{};let e={};for(let t=0;t<r.length;t++){let s=r[t];e[s.productNo]=[];for(let r=0;r<a.length;r++){let t=a[r];if(!(j[s.productNo]>=t)&&(d||Math.max(...a)!==t)){if(e[s.productNo].length>=o&&o>0)break;e[s.productNo].push(t)}}}return e})(),v=(()=>{if(!r||0===r.length)return{};let e={};for(let t=0;t<r.length;t++){let s=r[t],l=s.productNo,o=s.sales,n=0,d=0;for(let e=0;e<k[l].length;e++){let r=k[l][e];d+=o[r]||0,r===Math.max(...a)?n+=y:n++}if(0===n){e[l]=0;continue}e[s.productNo]=d/n}return e})(),S=(()=>{if(!r||0===r.length)return{};let e={};for(let t=0;t<r.length;t++){let s=r[t],l=s.productNo,a=s.stock||0,o=v[l],n=u[l]||1,d=Math.max(0,m/4*o-a);e[l]=d/n}return e})(),{restockList:w,restockTotal:C}=(()=>{if(!r||0===r.length)return{restockList:{},restockTotal:0};let e={...S},t={},s=0;for(let r=0;r<45;r++){let r=Object.keys(e).reduce((r,t)=>e[r]>e[t]?r:t);if(e[r]<=.5)break;t[r]||(t[r]=0),t[r]+=1,e[r]-=1,s+=1}return{restockList:t,restockTotal:s}})(),P=(e,r)=>{let t=e.target.value,s={...u,[r]:t?parseInt(t):0};b(s),localStorage.setItem("unitsPerPack",JSON.stringify(s))};return(0,s.jsxs)("div",{className:"overflow-x-auto",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of months to average",value:o,onChange:e=>{let r=e.target.value;n(r?parseInt(r):0)},min:"0"}),(0,s.jsx)("p",{className:"text-l font-bold",children:"Number of Months to average sales over (0 means average over all available data)"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2 mr-2",checked:d,onChange:e=>{c(e.target.checked)}}),(0,s.jsx)("p",{className:"text-l font-bold",children:"Include current month (current month is usually partial)"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter day of month of report",value:i,onChange:e=>{let r=e.target.value;h(r?parseInt(r):0)},min:"1",max:"31"}),(0,s.jsx)("p",{className:"text-l font-bold",children:"Day of month at time of report"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of weeks to restock",value:m,onChange:e=>{let r=e.target.value;p(r?parseInt(r):0)},min:"1"}),(0,s.jsx)("p",{className:"text-l font-bold",children:"Weeks to restock"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter max packs to restock",value:x,onChange:e=>{let r=e.target.value;g(r?parseInt(r):45)},min:"1"}),(0,s.jsx)("p",{className:"text-l font-bold",children:"Max packs to restock"})]}),(0,s.jsx)("div",{className:"flex items-center mb-4",children:(0,s.jsx)("button",{className:"bg-gray-500 text-white p-2 rounded mr-2",onClick:()=>{f(!N)},children:N?"Hide Table":"Show Table"})}),N&&(0,s.jsx)("div",{children:(0,s.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Units per Pack"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Stock"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Avg Monthly Sales"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock (Packs)"}),a.map(e=>(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:t[e]},e))]})}),(0,s.jsx)("tbody",{children:r.map((e,r)=>(0,s.jsxs)("tr",{className:r%2==0?"bg-black":"bg-gray-800",children:[(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:e.productNo}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:(0,s.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-[100%]",value:u[e.productNo]||"",onChange:r=>P(r,e.productNo),min:"0"})}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:e.description}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:e.stock}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:v[e.productNo].toFixed(2)}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:S[e.productNo].toFixed(2)}),a.map(r=>(0,s.jsx)("td",{className:"border border-gray-300 p-2 ".concat(k[e.productNo].includes(r)?"text-green-500":"text-red-500"),children:e.sales[r]||0},r))]},r))})]})}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Restock List: ",C]}),(0,s.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,s.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock Amount (Packs)"})]})}),(0,s.jsx)("tbody",{children:Object.keys(w).map((e,t)=>{var l;return(0,s.jsxs)("tr",{className:t%2==0?"bg-black":"bg-gray-800",children:[(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:e}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:(null==(l=r.find(r=>r.productNo===e))?void 0:l.description)||"N/A"}),(0,s.jsx)("td",{className:"border border-gray-300 p-2",children:w[e]})]},t)})})]})]})]})};function n(){let[e,r]=(0,l.useState)([]),t=(e=>{let r=[];for(let t=4;t<e.length;t++){let s=e[t-1].split("	"),l=e[t].split("	"),a=s.slice(-4).join("	")+l.slice(0,-4).join("	");r.push(a)}return r})(e),n=e=>/^\d{2}-\d{4}$/.test(e),d=(()=>{let r=new Set;for(let t=0;t<e.length;t++){let s=e[t].split("	");for(let e=0;e<s.length;e++)n(s[e])&&r.add(s[e])}let t=Array.from(r).sort((e,r)=>{let[t,s]=e.split("-").map(Number),[l,a]=r.split("-").map(Number);return s===a?t-l:s-a}),s={};return t.forEach((e,r)=>{s[r]=e}),s})(),c=(e=>{let r=[];for(let t=0;t<e.length;t++){let s=e[t].split("	"),l=s[0],a=s[1],o=s[2],c=parseInt(s[3]),i={},h=[];for(let e=4;e<s.length;e++)if(n(s[e])){let r=Object.entries(d).find(r=>r[1]===s[e]);if(r){let e=parseInt(r[0]);i[e]=0,h.push(e)}}let m=s.findIndex(e=>"Sold Qty"===e)+1;for(let e=0;e<h.length;e++)i[h[e]]=parseInt(s[m+e]);r.push({productNo:l,supplier:a,description:o,stock:c,sales:i})}return r})(t);return console.log("Product History:",c),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center mt-8",children:"Product Stock Check"}),(0,s.jsx)("p",{className:"text-center mt-4",children:"Upload a text file to check product stock."}),(0,s.jsx)(a,{onFileContentChange:e=>{r(e)}}),(0,s.jsx)(o,{productHistory:c,months:d})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[441,684,358],()=>r(6777)),_N_E=e.O()}]);