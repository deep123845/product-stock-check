(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6777:(e,t,r)=>{Promise.resolve().then(r.bind(r,6888))},6888:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});var l=r(5155),s=r(2115);let a=e=>{let{onFileContentChange:t}=e,[r,a]=(0,s.useState)(null),[o,n]=(0,s.useState)(null),d=e=>e.split("\n").filter(e=>e.length>0);return(0,l.jsxs)("div",{className:"p-4 border rounded shadow mt-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Upload and Parse Text File:"}),(0,l.jsx)("input",{type:"file",accept:".txt",onChange:e=>{var r;let l=null==(r=e.target.files)?void 0:r[0];if(l){a(l.name),n(null);let e=new FileReader;e.onload=e=>{if(e.target&&"string"==typeof e.target.result){let r=e.target.result;t&&t(d(r))}},e.onerror=()=>{n("Failed to read file."),t&&t([])},e.readAsText(l)}else a(null),n("No file selected."),t&&t([])},className:"mb-4"}),o&&(0,l.jsxs)("div",{className:"text-red-500 mb-2",children:["Error: ",o]}),r&&(0,l.jsxs)("p",{className:"mb-2",children:["Selected file: ",(0,l.jsx)("span",{className:"font-semibold",children:r})]})]})},o=e=>{let{productHistory:t,months:r}=e,a=Object.keys(r).map(Number).sort((e,t)=>t-e),[o,n]=(0,s.useState)(0),[d,c]=(0,s.useState)(!0),[i,h]=(0,s.useState)(new Date().getDate()),[m,p]=(0,s.useState)(4),u=(e=>{let t={};for(let r=0;r<e.length;r++){let l=e[r],s=Math.min(...Object.keys(l.sales).map(Number));t[l.productNo]=s}return t})(t),b=i/new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),x=(()=>{let e={};for(let r=0;r<t.length;r++){let l=t[r];e[l.productNo]=[];for(let t=0;t<a.length;t++){let r=a[t];if(!(u[l.productNo]>=r)&&(d||Math.max(...a)!==r)){if(e[l.productNo].length>=o&&o>0)break;e[l.productNo].push(r)}}}return e})(),g=(()=>{let e={};for(let r=0;r<t.length;r++){let l=t[r],s=l.productNo,o=l.sales,n=0,d=0;for(let e=0;e<x[s].length;e++){let t=x[s][e];d+=o[t]||0,t===Math.max(...a)?n+=b:n++}if(0===n){e[s]=0;continue}e[l.productNo]=d/n}return e})(),N=(()=>{let e={};for(let r=0;r<t.length;r++){let l=t[r],s=l.productNo,a=l.stock||0,o=Math.max(0,g[s]-a)/4;e[s]=o*m}return e})();return(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of months to average",value:o,onChange:e=>{let t=e.target.value;n(t?parseInt(t):0)},min:"0"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Number of Months to average sales over (0 means average over all available data)"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2 mr-2",checked:d,onChange:e=>{c(e.target.checked)}}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Include current month (current month is usually partial)"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter day of month of report",value:i,onChange:e=>{let t=e.target.value;h(t?parseInt(t):0)},min:"1",max:"31"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Day of month at time of report"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of weeks to restock",value:m,onChange:e=>{let t=e.target.value;p(t?parseInt(t):0)},min:"1"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Weeks to restock"})]}),(0,l.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Stock"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Avg Monthly Sales"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock"}),a.map(e=>(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:r[e]},e))]})}),(0,l.jsx)("tbody",{children:t.map((e,t)=>(0,l.jsxs)("tr",{className:t%2==0?"bg-black":"bg-gray-800",children:[(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.productNo}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.description}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.stock}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:g[e.productNo].toFixed(2)}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:N[e.productNo].toFixed(2)}),a.map(t=>(0,l.jsx)("td",{className:"border border-gray-300 p-2 ".concat(x[e.productNo].includes(t)?"text-green-500":"text-red-500"),children:e.sales[t]||0},t))]},t))})]})]})};function n(){let[e,t]=(0,s.useState)([]),r=(e=>{let t=[];for(let r=4;r<e.length;r++){let l=e[r-1].split("	"),s=e[r].split("	"),a=l.slice(-4).join("	")+s.slice(0,-4).join("	");t.push(a)}return t})(e),n=e=>/^\d{2}-\d{4}$/.test(e),d=(()=>{let t=new Set;for(let r=0;r<e.length;r++){let l=e[r].split("	");for(let e=0;e<l.length;e++)n(l[e])&&t.add(l[e])}let r=Array.from(t).sort((e,t)=>{let[r,l]=e.split("-").map(Number),[s,a]=t.split("-").map(Number);return l===a?r-s:l-a}),l={};return r.forEach((e,t)=>{l[t]=e}),l})(),c=(e=>{let t=[];for(let r=0;r<e.length;r++){let l=e[r].split("	"),s=l[0],a=l[1],o=l[2],c=parseInt(l[3]),i={},h=[];for(let e=4;e<l.length;e++)if(n(l[e])){let t=Object.entries(d).find(t=>t[1]===l[e]);if(t){let e=parseInt(t[0]);i[e]=0,h.push(e)}}let m=l.findIndex(e=>"Sold Qty"===e)+1;for(let e=0;e<h.length;e++)i[h[e]]=parseInt(l[m+e]);t.push({productNo:s,supplier:a,description:o,stock:c,sales:i})}return t})(r);return console.log("Product History:",c),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-center mt-8",children:"Product Stock Check"}),(0,l.jsx)("p",{className:"text-center mt-4",children:"Upload a text file to check product stock."}),(0,l.jsx)(a,{onFileContentChange:e=>{t(e)}}),(0,l.jsx)(o,{productHistory:c,months:d})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(6777)),_N_E=e.O()}]);