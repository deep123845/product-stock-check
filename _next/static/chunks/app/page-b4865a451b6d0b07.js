(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{6777:(e,r,t)=>{Promise.resolve().then(t.bind(t,9127))},9127:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>N});var l=t(5155),s=t(2115);let a=e=>{let{onFileContentChange:r}=e,[t,a]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),n=e=>/^\d{2}-\d{4}$/.test(e),c=e=>{let r=new Set;for(let t=0;t<e.length;t++){let l=e[t].split("	");for(let e=0;e<l.length;e++)n(l[e])&&r.add(l[e])}let t=Array.from(r).sort((e,r)=>{let[t,l]=e.split("-").map(Number),[s,a]=r.split("-").map(Number);return l===a?t-s:l-a}),l={};return t.forEach((e,r)=>{l[r]=e}),l},i=(e,r)=>{let t=[];for(let l=0;l<e.length;l++){let s=e[l].split("	"),a=s[0],o=s[1],d=s[2],c=parseInt(s[3]),i={},h=[];for(let e=4;e<s.length;e++)if(n(s[e])){let t=Object.entries(r).find(r=>r[1]===s[e]);if(t){let e=parseInt(t[0]);i[e]=0,h.push(e)}}let m=s.findIndex(e=>"Sold Qty"===e)+1;for(let e=0;e<h.length;e++)i[h[e]]=parseInt(s[m+e]);t.push({productNo:a,supplier:o,description:d,stock:c,sales:i})}return t},h=e=>{let r=[];for(let t=4;t<e.length;t++){let l=e[t-1].split("	"),s=e[t].split("	"),a=l.slice(-4).join("	")+s.slice(0,-4).join("	");r.push(a)}return r},m=e=>e.split("\n").filter(e=>e.length>0);return(0,l.jsxs)("div",{className:"p-4 border rounded shadow mt-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Upload and Parse Text File:"}),(0,l.jsx)("input",{type:"file",accept:".txt",onChange:e=>{var t;let l=null==(t=e.target.files)?void 0:t[0];if(l){a(l.name),d(null);let e=new FileReader;e.onload=e=>{if(e.target&&"string"==typeof e.target.result){let t=e.target.result;if(r){let e=m(t),l=c(e);r(i(h(e),l),l)}}},e.onerror=()=>{d("Failed to read file."),r&&r([],{})},e.readAsText(l)}else a(null),d("No file selected."),r&&r([],{})},className:"mb-4"}),o&&(0,l.jsxs)("div",{className:"text-red-500 mb-2",children:["Error: ",o]}),t&&(0,l.jsxs)("p",{className:"mb-2",children:["Selected file: ",(0,l.jsx)("span",{className:"font-semibold",children:t})]})]})},o=e=>{if(!e||0===e.length)return{};let r={};for(let t=0;t<e.length;t++){let l=e[t],s=Math.min(...Object.keys(l.sales).map(Number));r[l.productNo]=s}return r},d=e=>e/new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),n=(e,r,t,l)=>{if(!e||0===e.length)return{};let s={},a=o(e);for(let o=0;o<e.length;o++){let d=e[o];s[d.productNo]=[];for(let e=0;e<r.length;e++){let o=r[e];if(!(a[d.productNo]>=o)&&(l||Math.max(...r)!==o)){if(s[d.productNo].length>=t&&t>0)break;s[d.productNo].push(o)}}}return s},c=(e,r,t,l)=>{if(!e||0===e.length)return{};let s={},a=d(l);for(let l=0;l<e.length;l++){let o=e[l],d=o.productNo,n=o.sales,c=0,i=0;for(let e=0;e<t[d].length;e++){let l=t[d][e];i+=n[l]||0,l===Math.max(...r)?c+=a:c++}if(0===c){s[d]=0;continue}s[o.productNo]=i/c}return s},i=(e,r,t,l)=>{if(!e||0===e.length)return{};let s={};for(let a=0;a<e.length;a++){let o=e[a],d=o.productNo,n=o.stock||0,c=t[d],i=Math.max(0,r/4*c-n)/(l[d]||1);s[d]=i}return s},h=(e,r,t,l,s,a,o)=>{if(!e||0===e.length)return{restockList:{},restockTotal:0};let d={},n=0;for(let c=1;c<=r;c++){let r=i(e,c,t,l);Object.keys(s).forEach(e=>{s[e]&&delete r[e]});for(let t=0;t<e.length;t++){let s=e[t],o=s.productNo;if(r[o]){if(a[o]){let e=s.stock/l[o],t=Math.max(a[o]-e,0);r[o]=Math.min(t,r[o])}d[o]&&(r[o]=r[o]-d[o])}}for(;n<o;){let e=Object.keys(r).reduce((e,t)=>r[e]>r[t]?e:t);if(r[e]<.01)break;d[e]||(d[e]=0),d[e]+=1,r[e]-=1,n+=1}}let c={};for(let e of Object.keys(d).sort((e,r)=>d[r]-d[e]))c[e]=d[e];return{restockList:c,restockTotal:n}},m=(e,r)=>{let t={};for(let l in e){if(!r[l]){t[l]=0;continue}t[l]=e[l]/r[l]}return t},p=(e,r)=>e&&0!==e.length?Object.keys(r).reduce((e,t)=>e+(r[t]||0),0):0,u=(e,r)=>{if(!e||0===e.length)return 0;let t=0;for(let l of e)l.stock&&r[l.productNo]&&(t+=l.stock/r[l.productNo]);return t},b=e=>e&&0!==e.length?e.reduce((e,r)=>e+(r.stock||0),0):0,x=e=>{let{productHistory:r,productInfo:t,months:a}=e,o=Object.keys(a).map(Number).sort((e,r)=>r-e),[d,x]=(0,s.useState)(0),[g,N]=(0,s.useState)(!0),[f,j]=(0,s.useState)(new Date().getDate()),[y,k]=(0,s.useState)(4),[v,S]=(0,s.useState)({}),[C,w]=(0,s.useState)({}),[P,F]=(0,s.useState)(45),[I,O]=(0,s.useState)({}),[M,D]=(0,s.useState)(!0),[E,A]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("unitsPerPack");e&&S(JSON.parse(e));let r=localStorage.getItem("productDisabled");r&&w(JSON.parse(r));let t=localStorage.getItem("maxStockPerProduct");t&&O(JSON.parse(t))},[]);let T=(()=>{let e={...v};if(t)for(let r of t)void 0===e[r.UPC]&&(e[r.UPC]=r.unitsPerCase);return e})(),U=n(r,o,d,g),J=c(r,o,U,f),_=m(J,T),L=i(r,y,J,T),{restockList:R,restockTotal:B}=h(r,y,J,T,C,I,P),H=b(r),Q=u(r,T),W=p(r,J),Y=p(r,_),$=(e,r)=>{let t=e.target.value,l={...v,[r]:t?parseInt(t):-1};S(l),localStorage.setItem("unitsPerPack",JSON.stringify(l))},q=(e,r)=>{let t=e.target.value,l={...I,[r]:t?parseInt(t):-1};O(l),localStorage.setItem("maxStockPerProduct",JSON.stringify(l))},z=e=>{let r={...C,[e]:!C[e]};w(r),localStorage.setItem("productDisabled",JSON.stringify(r))};return(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of months to average",value:d,onChange:e=>{let r=e.target.value;x(r?parseInt(r):0)},min:"0"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Number of Months to average sales over (0 means average over all available data)"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2 mr-2",checked:g,onChange:e=>{N(e.target.checked)}}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Include current month (current month is usually partial)"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter day of month of report",value:f,onChange:e=>{let r=e.target.value;j(r?parseInt(r):0)},min:"1",max:"31"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Day of month at time of report"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of weeks to restock",value:y,onChange:e=>{let r=e.target.value;k(r?parseInt(r):0)},min:"1"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Weeks to restock"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter max packs to restock",value:P,onChange:e=>{let r=e.target.value;F(r?parseInt(r):45)},min:"1"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Max packs to restock"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2 mr-2",checked:E,onChange:()=>{A(!E)}}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Show average monthly sales in packs"})]}),(0,l.jsxs)("div",{className:"my-2",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Total Average Monthly Sales: ",E?Y.toFixed(2):W.toFixed(2)," packs"]}),(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Total Stock: ",E?Q.toFixed(2):H.toFixed(2)," packs"]})]}),(0,l.jsx)("div",{className:"flex items-center mb-4",children:(0,l.jsx)("button",{className:"bg-gray-500 text-white p-2 rounded mr-2",onClick:()=>{D(!M)},children:M?"Hide Table":"Show Table"})}),M&&(0,l.jsx)("div",{children:(0,l.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Disable"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Units per Pack"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Stock"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Avg Monthly Sales"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock (Packs)"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Max Stock"}),o.map(e=>(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:a[e]},e))]})}),(0,l.jsx)("tbody",{children:r.map((e,r)=>(0,l.jsxs)("tr",{className:r%2==0?"bg-black":"bg-gray-800",children:[(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.productNo}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2",checked:C[e.productNo]||!1,onChange:()=>z(e.productNo)})}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-[100%]",value:T[e.productNo]||"",onChange:r=>$(r,e.productNo),min:"0"})}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.description}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.stock}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:E?_[e.productNo].toFixed(2):J[e.productNo].toFixed(2)}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:L[e.productNo].toFixed(2)}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-[100%]",value:I[e.productNo]||"",onChange:r=>q(r,e.productNo),min:"0"})}),o.map(r=>(0,l.jsx)("td",{className:"border border-gray-300 p-2 ".concat(U[e.productNo].includes(r)?"text-green-500":"text-red-500"),children:e.sales[r]||0},r))]},r))})]})}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Restock List: ",B]}),(0,l.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"LCBO Number"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock Amount (Packs)"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Stock"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Avg Monthly Sales"}),o.map(e=>e<o.length-2?null:(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:a[e]},e))]})}),(0,l.jsx)("tbody",{children:Object.keys(R).map((e,s)=>{var a,d,n;return(0,l.jsxs)("tr",{className:s%2==0?"bg-black":"bg-gray-800",children:[(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(null==t||null==(a=t.find(r=>r.UPC===e))?void 0:a.LCBONumber)||"N/A"}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(null==(d=r.find(r=>r.productNo===e))?void 0:d.description)||"N/A"}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:R[e]}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(null==(n=r.find(r=>r.productNo===e))?void 0:n.stock)||0}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:E?_[e].toFixed(2):J[e].toFixed(2)}),o.map(t=>{var s;return t<o.length-2?null:(0,l.jsx)("td",{className:"border border-gray-300 p-2 ".concat(U[e].includes(t)?"text-green-500":"text-red-500"),children:(null==(s=r.find(r=>r.productNo===e))?void 0:s.sales[t])||0},t)})]},s)})})]})]})]})},g=e=>{let{onFileContentChange:r}=e,[t,a]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),n=e=>{let r=e.split("\n").filter(e=>e.length>0).map(e=>{let r=e.split(","),t=r[0].split('"')[1],l=parseInt(r[3].trim()),s=r[7].split('"')[1];return{LCBONumber:t,unitsPerCase:l,UPC:s,wholesalePrice:parseFloat(r[15].split('"')[1]),supplier:r[20].trim()}});return[...r.slice(1)]};return(0,l.jsxs)("div",{className:"p-4 border rounded shadow mt-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Upload and Parse Catalogue File:"}),(0,l.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var t;let l=null==(t=e.target.files)?void 0:t[0];if(l){a(l.name),d(null);let e=new FileReader;e.onload=e=>{if(e.target&&"string"==typeof e.target.result){let t=e.target.result;r&&r(n(t))}},e.onerror=()=>{d("Failed to read file."),r&&r([])},e.readAsText(l)}else a(null),d("No file selected."),r&&r([])},className:"mb-4"}),o&&(0,l.jsxs)("div",{className:"text-red-500 mb-2",children:["Error: ",o]}),t&&(0,l.jsxs)("p",{className:"mb-2",children:["Selected file: ",(0,l.jsx)("span",{className:"font-semibold",children:t})]})]})};function N(){let[e,r]=(0,s.useState)([]),[t,o]=(0,s.useState)({}),[d,n]=(0,s.useState)([]);return(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-center mt-8",children:"Product Stock Check"}),(0,l.jsx)("p",{className:"text-center mt-4",children:"Upload a text file to check product stock."}),(0,l.jsx)(g,{onFileContentChange:e=>{n(e)}}),(0,l.jsx)(a,{onFileContentChange:(e,t)=>{o(t),r(e)}}),(0,l.jsx)(x,{productHistory:e,months:t,productInfo:d})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[441,684,358],()=>r(6777)),_N_E=e.O()}]);