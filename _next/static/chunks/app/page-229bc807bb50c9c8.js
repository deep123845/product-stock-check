(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{128:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var l=r(5155),s=r(2115);let a=e=>{let{onFileContentChange:t}=e,[r,a]=(0,s.useState)(null),[o,n]=(0,s.useState)(null),d=e=>/^\d{2}-\d{4}$/.test(e),c=e=>{let t=new Set;for(let r=0;r<e.length;r++){let l=e[r].split("	");for(let e=0;e<l.length;e++)d(l[e])&&t.add(l[e])}let r=Array.from(t).sort((e,t)=>{let[r,l]=e.split("-").map(Number),[s,a]=t.split("-").map(Number);return l===a?r-s:l-a}),l={};return r.forEach((e,t)=>{l[t]=e}),l},i=(e,t)=>{let r=[];for(let l=0;l<e.length;l++){let s=e[l].split("	"),a=s[0],o=s[1],n=s[2],c=parseInt(s[3]),i={},h=[];for(let e=4;e<s.length;e++)if(d(s[e])){let r=Object.entries(t).find(t=>t[1]===s[e]);if(r){let e=parseInt(r[0]);i[e]=0,h.push(e)}}let m=s.findIndex(e=>"Sold Qty"===e)+1;for(let e=0;e<h.length;e++)i[h[e]]=parseInt(s[m+e]);r.push({productNo:a,supplier:o,description:n,stock:c,sales:i})}return r},h=e=>{let t=[];for(let r=4;r<e.length;r++){let l=e[r-1].split("	"),s=e[r].split("	"),a=l.slice(-4).join("	")+s.slice(0,-4).join("	");t.push(a)}return t},m=e=>e.split("\n").filter(e=>e.length>0);return(0,l.jsxs)("div",{className:"p-4 border rounded shadow mt-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Upload and Parse Text File:"}),(0,l.jsx)("input",{type:"file",accept:".txt",onChange:e=>{var r;let l=null==(r=e.target.files)?void 0:r[0];if(l){a(l.name),n(null);let e=new FileReader;e.onload=e=>{if(e.target&&"string"==typeof e.target.result){let r=e.target.result;if(t){let e=m(r),l=c(e);t(i(h(e),l),l)}}},e.onerror=()=>{n("Failed to read file."),t&&t([],{})},e.readAsText(l)}else a(null),n("No file selected."),t&&t([],{})},className:"mb-4"}),o&&(0,l.jsxs)("div",{className:"text-red-500 mb-2",children:["Error: ",o]}),r&&(0,l.jsxs)("p",{className:"mb-2",children:["Selected file: ",(0,l.jsx)("span",{className:"font-semibold",children:r})]})]})},o=e=>{let{productHistory:t,productInfo:r,months:a}=e,o=Object.keys(a).map(Number).sort((e,t)=>t-e),[n,d]=(0,s.useState)(0),[c,i]=(0,s.useState)(!0),[h,m]=(0,s.useState)(new Date().getDate()),[p,u]=(0,s.useState)(4),[b,x]=(0,s.useState)({}),[g,N]=(0,s.useState)({}),[f,j]=(0,s.useState)(45),[y,k]=(0,s.useState)(!0),[v,S]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("unitsPerPack");e&&x(JSON.parse(e));let t=localStorage.getItem("productDisabled");t&&N(JSON.parse(t))},[]);let w=(()=>{let e={...b};if(r)for(let t of r)void 0===e[t.UPC]&&(e[t.UPC]=t.unitsPerCase);return e})(),C=(e=>{if(!e||0===e.length)return{};let t={};for(let r=0;r<e.length;r++){let l=e[r],s=Math.min(...Object.keys(l.sales).map(Number));t[l.productNo]=s}return t})(t),P=h/new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),I=(()=>{if(!t||0===t.length)return{};let e={};for(let r=0;r<t.length;r++){let l=t[r];e[l.productNo]=[];for(let t=0;t<o.length;t++){let r=o[t];if(!(C[l.productNo]>=r)&&(c||Math.max(...o)!==r)){if(e[l.productNo].length>=n&&n>0)break;e[l.productNo].push(r)}}}return e})(),F=(()=>{if(!t||0===t.length)return{};let e={};for(let r=0;r<t.length;r++){let l=t[r],s=l.productNo,a=l.sales,n=0,d=0;for(let e=0;e<I[s].length;e++){let t=I[s][e];d+=a[t]||0,t===Math.max(...o)?n+=P:n++}if(0===n){e[s]=0;continue}e[l.productNo]=d/n}return e})(),D=e=>{if(!t||0===t.length)return{};let r={};for(let l=0;l<t.length;l++){let s=t[l],a=s.productNo,o=s.stock||0,n=F[a],d=w[a]||1,c=Math.max(0,e/4*n-o);r[a]=c/d}return r},E=D(p),{restockList:O,restockTotal:M}=(()=>{if(!t||0===t.length)return{restockList:{},restockTotal:0};let e={},r=0;for(let t=1;t<=p;t++){let l=D(t);for(let t in Object.keys(g).forEach(e=>{g[e]&&delete l[e]}),l)e[t]&&(l[t]=l[t]-e[t]);for(;r<f;){let t=Object.keys(l).reduce((e,t)=>l[e]>l[t]?e:t);if(l[t]<.5)break;e[t]||(e[t]=0),e[t]+=1,l[t]-=1,r+=1}}return{restockList:e,restockTotal:r}})(),T=(()=>{if(!t||0===t.length)return 0;let e=0;for(let t in F)e+=F[t]/w[t];return e})(),A=(()=>{if(!t||0===t.length)return 0;let e=0;for(let r of t)e+=r.stock/w[r.productNo];return e})(),U=(e,t)=>{let r=e.target.value,l={...b,[t]:r?parseInt(r):-1};x(l),localStorage.setItem("unitsPerPack",JSON.stringify(l))},_=e=>{let t={...g,[e]:!g[e]};N(t),localStorage.setItem("productDisabled",JSON.stringify(t))};return(0,l.jsxs)("div",{className:"overflow-x-auto",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of months to average",value:n,onChange:e=>{let t=e.target.value;d(t?parseInt(t):0)},min:"0"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Number of Months to average sales over (0 means average over all available data)"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2 mr-2",checked:c,onChange:e=>{i(e.target.checked)}}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Include current month (current month is usually partial)"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter day of month of report",value:h,onChange:e=>{let t=e.target.value;m(t?parseInt(t):0)},min:"1",max:"31"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Day of month at time of report"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter number of weeks to restock",value:p,onChange:e=>{let t=e.target.value;u(t?parseInt(t):0)},min:"1"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Weeks to restock"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-1/8 mr-2",placeholder:"Enter max packs to restock",value:f,onChange:e=>{let t=e.target.value;j(t?parseInt(t):45)},min:"1"}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Max packs to restock"})]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2 mr-2",checked:v,onChange:()=>{S(!v)}}),(0,l.jsx)("p",{className:"text-l font-bold",children:"Show average monthly sales in packs"})]}),(0,l.jsxs)("div",{className:"my-2",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Total Average Monthly Sales: ",T.toFixed(2)," packs"]}),(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Total Stock: ",A.toFixed(2)," packs"]})]}),(0,l.jsx)("div",{className:"flex items-center mb-4",children:(0,l.jsx)("button",{className:"bg-gray-500 text-white p-2 rounded mr-2",onClick:()=>{k(!y)},children:y?"Hide Table":"Show Table"})}),y&&(0,l.jsx)("div",{children:(0,l.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Disable"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Units per Pack"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Stock"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Avg Monthly Sales"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock (Packs)"}),o.map(e=>(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:a[e]},e))]})}),(0,l.jsx)("tbody",{children:t.map((e,t)=>(0,l.jsxs)("tr",{className:t%2==0?"bg-black":"bg-gray-800",children:[(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.productNo}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(0,l.jsx)("input",{type:"checkbox",className:"border border-gray-300 p-2",checked:g[e.productNo]||!1,onChange:()=>_(e.productNo)})}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(0,l.jsx)("input",{type:"number",className:"border border-gray-300 p-2 w-[100%]",value:w[e.productNo]||"",onChange:t=>U(t,e.productNo),min:"0"})}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.description}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e.stock}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(F[e.productNo]/(v?w[e.productNo]:1)).toFixed(2)}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:E[e.productNo].toFixed(2)}),o.map(t=>(0,l.jsx)("td",{className:"border border-gray-300 p-2 ".concat(I[e.productNo].includes(t)?"text-green-500":"text-red-500"),children:e.sales[t]||0},t))]},t))})]})}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Restock List: ",M]}),(0,l.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Product No"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Description"}),(0,l.jsx)("th",{className:"border border-gray-300 p-2",children:"Restock Amount (Packs)"})]})}),(0,l.jsx)("tbody",{children:Object.keys(O).map((e,r)=>{var s;return(0,l.jsxs)("tr",{className:r%2==0?"bg-black":"bg-gray-800",children:[(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:e}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:(null==(s=t.find(t=>t.productNo===e))?void 0:s.description)||"N/A"}),(0,l.jsx)("td",{className:"border border-gray-300 p-2",children:O[e]})]},r)})})]})]})]})},n=e=>{let{onFileContentChange:t}=e,[r,a]=(0,s.useState)(null),[o,n]=(0,s.useState)(null),d=e=>{let t=e.split("\n").filter(e=>e.length>0).map(e=>{let t=e.split(","),r=t[0].split('"')[1],l=parseInt(t[3].trim()),s=t[7].split('"')[1];return{LCBONumber:r,unitsPerCase:l,UPC:s,wholesalePrice:parseFloat(t[15].split('"')[1]),supplier:t[20].trim()}});return[...t.slice(1)]};return(0,l.jsxs)("div",{className:"p-4 border rounded shadow mt-8",children:[(0,l.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Upload and Parse Catalogue File:"}),(0,l.jsx)("input",{type:"file",accept:".csv",onChange:e=>{var r;let l=null==(r=e.target.files)?void 0:r[0];if(l){a(l.name),n(null);let e=new FileReader;e.onload=e=>{if(e.target&&"string"==typeof e.target.result){let r=e.target.result;t&&t(d(r))}},e.onerror=()=>{n("Failed to read file."),t&&t([])},e.readAsText(l)}else a(null),n("No file selected."),t&&t([])},className:"mb-4"}),o&&(0,l.jsxs)("div",{className:"text-red-500 mb-2",children:["Error: ",o]}),r&&(0,l.jsxs)("p",{className:"mb-2",children:["Selected file: ",(0,l.jsx)("span",{className:"font-semibold",children:r})]})]})};function d(){let[e,t]=(0,s.useState)([]),[r,d]=(0,s.useState)({}),[c,i]=(0,s.useState)([]);return(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-center mt-8",children:"Product Stock Check"}),(0,l.jsx)("p",{className:"text-center mt-4",children:"Upload a text file to check product stock."}),(0,l.jsx)(n,{onFileContentChange:e=>{i(e)}}),(0,l.jsx)(a,{onFileContentChange:(e,r)=>{d(r),t(e)}}),(0,l.jsx)(o,{productHistory:e,months:r,productInfo:c})]})}},6777:(e,t,r)=>{Promise.resolve().then(r.bind(r,128))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(6777)),_N_E=e.O()}]);